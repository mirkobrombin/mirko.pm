---
title: 'I nostri dati al sicuro con Rsync'
date: 2017-07-19
layout: post
author: Mirko B.
author_github: mirkobrombin
tags:
  - ssh
---
La prima regola quando si lavora al PC, a mio avviso, è la <i>SICUREZZA</i> per i nostri dati che faticosamente abbiamo prodotto e accumulato nel tempo.Quale momento più indicato di questo per fare un pò&nbsp; i conti con le copie di backup e magari automatizzarle? Mettere ordine in quello che spesso è il caos dei files ripetuti e sparsi nelle varie directory?<span id="more-179"></span>Chiarisco subito che la soluzione descritta in questo articolo non è la più completa ,esistono sistemi più avanzati, nè questo post vuol essere una guida esaustiva per il backup dei dati.Lo strumento che andiamo ad utilizzare per fare tutto il lavoro si chiama <b>RSync</b>; è un programma utilizzabile a linea di comando ed è già disponibile nella vostra distribuzione Linux.Per chi non ama lavorare da terminale esistono software che rendono possibile l'uso di Rsync anche da ambiente grafico, una guida scritta da <a href="https://linuxhub.it/author/giuliano-zamboni/">Giuliano Zamboni</a> è presente su questo sito all' indirizzo <a href="https://linuxhub.it/2017/07/17/backup-mirati-con-grsync/">Backup mirati con Grsync</a>.Contrariamente a quanto potrebbe sembrare RSync è uno strumento molto potente con molte funzioni che possiamo combinare per ottenere il risultato&nbsp; desiderato, in particolare permette di sincronizzare i files con un backup anche incrementale, comprimerli in tempo reale per minimizzare i dati da trasferire, copiare ricorsivamente le cartelle e molto altro.In fondo all’articolo metterò il link per chi volesse approfondire l’argomento, è comunque sempre disponibile il prezioso <i><b>man</b></i> quindi, in caso, usiamolo ?<b><i></i></b><b><i>Iniziamo!</i></b>Cominciamo col dire che nel programmare il backup dei nostri dati&nbsp; abbiamo due possibilità:1) copiare i dati in <i>locale</i>;2) copiare i dati in <i>remoto</i>.Analizziamo le due possibilità cominciando col backup in locale, che tra l’altro è delle due la soluzione più semplice.Come ogni programma che si rispetti RSync ha la tipica sintassi :<b>rsync opzione&nbsp; sorgente&nbsp; destinazione</b>innanzitutto vediamo alcune semplici opzioni di uso comune:-v : abilita l’ output dell’operazione in corso ed eventuali errori-r : copia ricorsivamente i files contenuti all’interno delle directory-h : scrive in forma più <i>umanamente</i> leggibili le cifre-a : copia ricorsivamente i files e ne mantiene inalterati gli attributi, i permessi e tutte le caratteristiche-z : attiva la compressione dei dati in tempo reale— delete : cancella i files che sono stati concellati nel PC sorgente— exclude : esclude singoli tipi di files— existing: sincronizza solo i files già presenti nel PC destinazione<b>1 – Backup locale</b>Vediamo quindi come copiare i dati in locale , cioè con sorgente e destinazione diverse ma stesso PC.Questa è la modalità più semplice e veloce, basta creare la cartelle destinazione e dare in pasto a rsync i parametri che abbiamo visto in precedenza, per es.<code>rsync -vrhz /home/utente /copiadati</code>questo comando effettua la copia di tutta la cartella home dell’utente in modo incrementale, ricorsivo con compressione dati nella cartella <i>copiadati</i>, da notare che la compressione dati non crea file compressi ma utilizza algoritmi di compressione solo per il trasferimento dati.Per automatizzare la procedura è possibile creare uno script per eseguire la copia all’avvio del PC o programmare con il comando cron l’esecuzione.<b>2 – Backup remoto</b>La seconda opzione è fare il backup di directories locali su PC remoto e viceversa, potremo così avere un PC che contiene le copie aggiornate di tutti i dati sparsi sui vari PC che utilizziamo.Una caratteristica di RSync, sempre a proposito della sicurezza, è la trasmissione dei dati su rete in modo cifrato utilizzando una connessione SSH tra sorgente e destinazione in modo da essere sicuri che nessuno possa intercettare e leggere i nostri dati.Qualora il PC destinazione non avesse installato il demone server ssh sarà necessario installarlo , digitando:<code>sudo apt-get install openssh-server</code>fatto questo possiamo procedere al backup.Creiamo una directory che conterrà le nostre copie dei dati con<code>mkdir /home/utente/copiadati</code><code></code>e dal pc sorgente digitiamo la stesso comando che abbiamo visto nel primo caso ma specificando come destinazione il server ssh :<code>rsync -vrhz /home/utente&nbsp; nomeutente@ip_host:/home/utente/copiadati</code>a questo punto ci verrà chiesto di confermare la connessione e accettiamo, successivamente alla richiesta digitiamo la password di <i>nomeutente </i>e il gioco è fatto!Naturalmente il gioco funziona anche al contrario, cioè copiare dati remoti su un PC locale, basta invertire i parametri.Per adesso è tutto,alla prossima!<i>Per approfondimenti è possibile consultare il link <a href="https://www.samba.org/ftp/rsync/rsync.html" target="_blank" rel="noopener noreferrer">https://www.samba.org/ftp/rsync/rsync.html</a></i>